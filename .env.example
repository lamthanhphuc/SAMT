# ==============================================
# SAMT MICROSERVICES - ENVIRONMENT VARIABLES
# ==============================================
# ⚠️  SECURITY: Copy this file to .env and generate STRONG secrets!
# ⚠️  WARNING: Never commit .env files to version control!
# ⚠️  REQUIRED: All variables marked as REQUIRED must be set before startup

# ==============================================
#   CRITICAL SECURITY CONFIGURATION (REQUIRED)
# ==============================================

# JWT Secret - REQUIRED (Minimum 256-bit / 32+ characters)
# Generate with: openssl rand -base64 64
# Must be at least 32 bytes for security
JWT_SECRET=GENERATE_STRONG_512_BIT_SECRET_HERE

# Gateway Internal Secret - REQUIRED (For inter-service communication)
# Generate with: openssl rand -base64 32  
GATEWAY_INTERNAL_SECRET=GENERATE_STRONG_GATEWAY_SECRET_HERE

# Redis Password - REQUIRED (For rate limiting and caching)
# Generate with: openssl rand -base64 32
REDIS_PASSWORD=GENERATE_STRONG_REDIS_PASSWORD_HERE

# CORS Allowed Origins - REQUIRED for production
# Comma-separated list of allowed origins (no wildcards!)
# Example: https://app.domain.com,https://admin.domain.com
CORS_ALLOWED_ORIGINS=https://your-frontend-domain.com

# ==============================================
#   DATABASE CREDENTIALS (REQUIRED)
# ==============================================

# PostgreSQL Admin User
POSTGRES_USER=postgres

# PostgreSQL Password - REQUIRED
# Generate with: openssl rand -base64 32
# Must be strong for production!
POSTGRES_PASSWORD=GENERATE_STRONG_DB_PASSWORD_HERE

# Database Names (Change if needed)
DB_IDENTITY_NAME=samt_identity
DB_CORE_NAME=samt_core  
DB_PROJECTCONFIG_NAME=projectconfig_db
DB_USERGROUP_NAME=samt_usergroup
DB_SYNC_NAME=sync_db

# ==============================================
#   APPLICATION PORTS (Internal Container Ports)
# ==============================================
API_GATEWAY_PORT=9080
IDENTITY_SERVICE_PORT=8081
IDENTITY_SERVICE_GRPC_PORT=9091
USER_GROUP_SERVICE_PORT=8082
USER_GROUP_SERVICE_GRPC_PORT=9095
SYNC_SERVICE_PORT=8083
PROJECT_CONFIG_SERVICE_PORT=8084
ANALYSIS_SERVICE_PORT=8087
REPORT_SERVICE_PORT=8088
NOTIFICATION_SERVICE_PORT=8085

# ==============================================  
#   EXTERNAL DATABASE PORTS (Host -> Container)
# ==============================================
# WARNING: Only expose ports in development!
# Production should use internal networking only
POSTGRES_IDENTITY_PORT=5432
POSTGRES_CORE_PORT=5433
POSTGRES_PROJECTCONFIG_PORT=5434
POSTGRES_USERGROUP_PORT=5435
POSTGRES_SYNC_PORT=5436

# Redis Port (Internal only in production)
REDIS_PORT=6379

# ==============================================
#   KAFKA CONFIGURATION
# ==============================================
KAFKA_ENABLED=true
KAFKA_PORT=9092
KAFKA_BOOTSTRAP_SERVERS=localhost:9092

# ==============================================
#   SPRING CONFIGURATION
# ==============================================
SPRING_PROFILES_ACTIVE=docker

# Redis Connection (Internal container networking)
SPRING_DATA_REDIS_HOST=redis
SPRING_DATA_REDIS_PORT=6379

# ==============================================
#   JVM TUNING
# ==============================================
JAVA_OPTS=-Xms256m -Xmx512m -XX:+UseG1GC -XX:MaxGCPauseMillis=200

# ==============================================
#   LOGGING CONFIGURATION
# ==============================================
LOG_LEVEL=INFO
GATEWAY_LOG_LEVEL=INFO
SHOW_SQL=false
SQL_LOG_LEVEL=WARN

# ==============================================
#   DATABASE TUNING
# ==============================================
DDL_AUTO=validate
DB_POOL_SIZE=10
DB_POOL_MIN_IDLE=2

# ==============================================
#   SECURITY SETTINGS
# ==============================================
# Swagger UI (Disable in production!)
SWAGGER_ENABLED=false

# Trusted Proxy IPs (for rate limiting behind load balancer)
TRUSTED_PROXIES=127.0.0.1,::1

# ==============================================
#   SETUP INSTRUCTIONS
# ==============================================
# 
# 1. Copy this file: cp .env.example .env
# 2. Generate secrets using commands above
# 3. Set strong database password  
# 4. Configure CORS_ALLOWED_ORIGINS for your domain
# 5. Set appropriate LOG_LEVEL (INFO for prod, DEBUG for dev)
# 6. Verify all REQUIRED variables are set
# 7. Never commit the .env file!
#
# Quick secret generation:
# JWT_SECRET=$(openssl rand -base64 64)
# GATEWAY_INTERNAL_SECRET=$(openssl rand -base64 32) 
# REDIS_PASSWORD=$(openssl rand -base64 32)
# POSTGRES_PASSWORD=$(openssl rand -base64 32)
